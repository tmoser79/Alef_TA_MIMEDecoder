Splunk MIME Decoder add-on allows for decoding MIME-encoded (URL-encoded) strings. It was developped to decode field values containing ciphered email subjects as a byproduct of pass-through Cisco ESA email proxy. Add-on provides a custom search command to do this. The main advantage of this command is that it is able to decode any MIME-encoded string in any charset, not just in UTF-8 which is a limitation of standard SPL eval function `urldecode`.

Originally the main purpose of of this 

# System Requirements

None

# Installation

Install on Splunk Search Head only.

# Configuration

No need to configure this app.

# Usage

Use command as per example below. Input and output fields may have the same name.

## Syntax:
`| mimedecode <field_with_encoded_text> <field_with_decoded_text>`

## Example:
`| makeresults count=1`
`| eval field1_in="=?UTF-8?Q?Alert_Google_=E2=80=93_Bank_of_England?="`
`| eval field2_in="=?ISO-8859-2?Q?RE=3A_Odpov=EC=EF=3A_Terasy_C1?="`
`| mimedecode field1_in field1_out`
`| mimedecode field2_in field2_out`

<table>\
<tr><td>Input String</td><td>Input MIME-encoded Charset</td><td>Output String</td>
<tr><td>=?UTF-8?Q?Alert_Google_=E2=80=93_Bank_of_England?=</td><td>UTF-8</td><td>Alert Google - Bank of England</td>
<tr><td>=?ISO-8859-2?Q?RE=3A_Odpov=EC=EF=3A_Terasy_C1?=</td><td>ISO-8859-2</td><td>RE: Odpověď: Terasy C1</td>
</table>

# Testing:
Add-on was successfully tested with these charsets: UTF8, Windows-1250, ISO-8859-2. However, it should work for many others charsets just as well. 

This add-on relies on Python and its `email` standard library (an email and MIME handling package). You can check details at https://docs.python.org/3/library/email.header.html.

# Bugs
There were some issue with Japanese charset. This has to be investigated more.

# Release Notes
- 1.0.0     initial release
- 1.0.1     fixed cosmetic issues
- 1.0.2     fixed an issue: command failed when an event does not contain a field being decoded (exception)
